{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Archivos Subidos</title>
    
    <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-storage-compat.js"></script>
    <script type="text/javascript" src="{% static 'chessapp/accesibilidad.js' %}"></script>


    
</head>

<body>

    <style>
        body {
            background-image: url("{% static 'chessapp/images/ajedrez_fondo.jpg' %}");
            background-size: cover;
            color: white;
        }
    

  

   
    </style>
    <div class="partida-card" id="archivosContainer">
        <h1>Mis Partidas Guardadas</h1>
        <!-- Ejemplo de una partida guardada -->
        <div class="archivo-item">
            <h3>Partida 1</h3>
            <p><strong>Fecha:</strong> 2024-11-13</p>
            <p><strong>Resultado:</strong> Victoria</p>
        </div>
        <
    </div>

    <script>
        
        // Funci칩n para cargar los archivos del usuario
        document.addEventListener('DOMContentLoaded', function() {
            auth.onAuthStateChanged(function(user) {
                if (user) {
                    console.log("Cargando archivos para el usuario:", user.uid);

                    // Referencia a la colecci칩n de archivos del usuario
                    db.collection('usuarios').doc(user.uid).collection('archivosPGN').get()
                        .then(function(querySnapshot) {
                            const container = document.getElementById('archivosContainer');
                            if (querySnapshot.empty) {
                                container.innerHTML = '<p>No se encontraron archivos.</p>';
                            } else {
                                querySnapshot.forEach(function(doc) {
                                    const data = doc.data();
                                    const fileName = data.nombreArchivo;
                                    const fileURL = data.urlArchivo;

                                    // Crear un elemento de enlace para descargar el archivo
                                    const link = document.createElement('a');
                                    link.href = fileURL;
                                    link.textContent = fileName;
                                    link.setAttribute('download', fileName);
                                    link.style.display = 'block';

                                    // A침adir el enlace al contenedor
                                    container.appendChild(link);
                                });
                            }
                        })
                        .catch(function(error) {
                            console.error("Error al cargar los archivos:", error);
                        });
                } else {
                    console.warn("Usuario no autenticado. Inicia sesi칩n para ver tus archivos.");
                }
            });
        });
    </script>
</body>
</html>
